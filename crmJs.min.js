var crmJsConfig={apiVersion:"8.1"},crmJs={api:{get:function(e,t,o){if(this.context.loaded||this.context.init(),"undefined"==typeof jQuery){if("function"!=typeof t)return void console.error("Callback not defined");var n=new XMLHttpRequest;n.open("GET",crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+e),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Prefer","odata.include-annotations=OData.Community.Display.V1.FormattedValue"),n.setRequestHeader("OData-MaxVersion","4.0"),n.setRequestHeader("OData-Version","4.0"),n.onload=function(){if(200!==n.status)return console.error(n.responseText),void("function"==typeof o&&o(n.responseText));var e=JSON.parse(n.responseText);t(e)},n.send()}else{if("function"!=typeof t)return $.ajax({type:"GET",url:crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+e,headers:{Accept:"application/json",Prefer:"odata.include-annotations=OData.Community.Display.V1.FormattedValue","OData-MaxVersion":"4.0","OData-Version":"4.0"}});$.ajax({type:"GET",url:crmJs.api.context.clientUrl+"/api/data/v8.0/"+e,headers:{Accept:"application/json",Prefer:"odata.include-annotations=OData.Community.Display.V1.FormattedValue","OData-MaxVersion":"4.0","OData-Version":"4.0"},success:t,error:o})}},post:function(e,t,o,n){if(this.context.loaded||this.context.init(),"undefined"==typeof jQuery){if("function"!=typeof o)return void console.error("Callback not defined");var r=new XMLHttpRequest;r.open("POST",crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+e),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Prefer","odata.include-annotations=OData.Community.Display.V1.FormattedValue"),r.setRequestHeader("OData-MaxVersion","4.0"),r.setRequestHeader("OData-Version","4.0"),r.onload=function(){if(200!==r.status)return console.error(r.responseText),void("function"==typeof n&&n(r.responseText));var e=JSON.parse(r.responseText);o(e)},r.send(t)}else{if("function"!=typeof o)return $.ajax({type:"POST",url:crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+e,data:t,headers:{"Content-Type":"application/json"}});$.ajax({type:"POST",url:crmJs.api.context.clientUrl+"/api/data/v8.0/"+e,data:t,headers:{"Content-Type":"application/json"},success:o,error:n})}},put:function(e,t,o,n){if(this.context.loaded||this.context.init(),"undefined"==typeof jQuery){if("function"!=typeof o)return void console.error("Callback not defined");var r=crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+e,a=new XMLHttpRequest;a.open("PUT",r),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Prefer","odata.include-annotations=OData.Community.Display.V1.FormattedValue"),a.setRequestHeader("OData-MaxVersion","4.0"),a.setRequestHeader("OData-Version","4.0"),a.onload=function(){if(200!==a.status)return console.error(a.responseText),void("function"==typeof n&&n(a.responseText));var e=JSON.parse(a.responseText);o(e)},a.send(t)}else{if("function"!=typeof o)return $.ajax({type:"PUT",url:crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+e,data:t,headers:{"Content-Type":"application/json","OData-MaxVersion":"4.0","OData-Version":"4.0"}});$.ajax({type:"PUT",url:crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+e,data:t,headers:{"Content-Type":"application/json","OData-MaxVersion":"4.0","OData-Version":"4.0"},success:o,error:n})}},workflows:{run:function(e,t,o,n){crmJs.api.context.loaded||crmJs.api.context.init();var r={EntityId:o},a=crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/workflows("+e+")/Microsoft.Dynamics.CRM.ExecuteWorkflow";req.open("POST",a,!1),req.setRequestHeader("Accept","application/json"),req.setRequestHeader("Content-Type","application/json; charset=utf-8"),req.setRequestHeader("OData-MaxVersion","4.0"),req.setRequestHeader("OData-Version","4.0"),req.onreadystatechange=function(){4==this.readyState&&(req.onreadystatechange=null,200==this.status||204==this.status?void 0!=typeof n&&alert(n):console.error(this.responseText))},req.send(JSON.stringify(r))}},actions:{run:function(e,t,o,n){crmJs.api.context.loaded||crmJs.api.context.init();var r=crmJs.api.context.clientUrl+"/api/data/v"+crmJsConfig.apiVersion+"/"+t+"("+o+")/Microsoft.Dynamics.CRM."+e,a=new XMLHttpRequest;a.open("POST",r,!1),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Content-Type","application/json; charset=utf-8"),a.setRequestHeader("OData-MaxVersion","4.0"),a.setRequestHeader("OData-Version","4.0"),a.onreadystatechange=function(){if(4==this.readyState)if(a.onreadystatechange=null,200==this.status&&"function"==typeof n){var e=JSON.parse(this.responseText);n(e)}else 200==this.status||204==this.status?console.log("succeeded"):(console.log("failed"),console.error(this.responseText))},a.send()}},context:{loaded:!1,context:{},clientUrl:"",init:function(){this.context=this.getContext(),this.clientUrl=this.context.getClientUrl(),this.loaded=!0},getContext:function(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm)return Xrm.Page.context;throw new Error("Context is not available.")}}},form:{getType:function(){var e=Xrm.Page.ui.getFormType();if(null!=e){var t="";switch(e){case 1:t="Create";break;case 2:t="Update";break;case 3:t="Read Only";break;case 4:t="Disabled";break;case 5:t="Quick Create";break;case 6:t="Bulk Edit";break;case 11:t="Read Optimized";break;default:console.error("No valid form type returned")}return""==t?null:t}console.error("No valid form type return")},getValue:function(e){var t=Xrm.Page.getAttribute(e);if(null!=t&&"function"==typeof t.getValue){var o=t.getValue();return Array.isArray(o)?o[0]:o}console.error('Attribute "'+e+'" does not exist on the form')},setValue:function(e,t){var o=Xrm.Page.getAttribute(e);return null==o||"function"!=typeof o.getValue?(console.error('Attribute "'+e+'" does not exist on the form'),!1):(o.setValue(t),!0)},setLookup:function(e,t,o,n){var r=Xrm.Page.getAttribute(e);if(null!=r&&"function"==typeof r.getValue){var a=new Array;a[0]={id:t,name:o,entityType:n},r.setValue(a)}else console.error('Attribute "'+e+'" does not exist on the form')},getCurrentEntityId:function(){return Xrm.Page.data.entity.getId()},businessRequired:{setRequired:function(e){var t=Xrm.Page.getAttribute(e);if(null!=t&&"function"==typeof t.getValue)return t.setRequiredLevel("required"),!0;console.error('Attribute "'+e+'" does not exist on the form')},setOptional:function(e){var t=Xrm.Page.getAttribute(e);null!=t&&"function"==typeof t.getValue?t.setRequiredLevel("none"):console.error('Attribute "'+e+'" does not exist on the form')}},visibility:{setVisible:function(e){var t=Xrm.Page.getControl(e);null!=t&&"function"==typeof t.setVisible?t.setVisible(!0):console.error('The control for attribute "'+e+'" does not exist on the form')},setHidden:function(e){var t=Xrm.Page.getControl(e);null!=t&&"function"==typeof t.setVisible?t.setVisible(!1):console.error('The control for attribute "'+e+'" does not exist on the form')},tabs:{setVisible:function(e){null!=Xrm.Page.ui.tabs.get(e)?Xrm.Page.ui.tabs.get(e).setVisible(!0):console.error("Tab "+e+" does not exist on the form")},setHidden:function(e){null!=Xrm.Page.ui.tabs.get(e)?Xrm.Page.ui.tabs.get(e).setVisible(!1):console.error("Tab "+e+" does not exist on the form")}},sections:{setVisible:function(e,t){null!=Xrm.Page.ui.tabs.get(e)?null!=Xrm.Page.ui.tabs.get(e).sections.get(t)?Xrm.Page.ui.tabs.get(e).sections.get(t).setVisible(!0):console.error("Section "+t+" does not exist in the tab "+e):console.error("Tab "+e+" does not exist on the form")},setHidden:function(e,t){null!=Xrm.Page.ui.tabs.get(e)?null!=Xrm.Page.ui.tabs.get(e).sections.get(t)?Xrm.Page.ui.tabs.get(e).sections.get(t).setVisible(!1):console.error("Section "+t+" does not exist in the tab "+e):console.error("Tab "+e+" does not exist on the form")}}},readonly:{enable:function(e){var t=Xrm.Page.getControl(e);null!=t&&"function"==typeof t.setDisabled?t.setDisabled(!1):console.error('The control for attribute "'+e+'" does not exist on the form')},disable:function(e){var t=Xrm.Page.getControl(e);null!=t&&"function"==typeof t.setDisabled?t.setDisabled(!0):console.error('The control for attribute "'+e+'" does not exist on the form')}},fieldError:{set:function(e,t){Xrm.Page.getControl(e).setNotification(t)},clear:function(e){Xrm.Page.getControl(e).clearNotification()}}}};
